10 REM Player is 0 = 1
20 REM Computer is X = 2
30 GOSUB 220
40 GOSUB 330
50 LET P = RND(2)
60 IF P = 1 GOTO 100
70 PRINT "THE COMPUTER, AS X, WILL GO FIRST"
80 PRINT
90 GOTO 160
100 PRINT "THE PLAYER, AS O, WILL GO FIRST"
110 PRINT
120 LET P = 1
130 GOSUB 1920
140 GOSUB 330
150 GOSUB 1600
160 LET P = 2
170 GOSUB 700
180 GOSUB 330
190 GOSUB 1600
200 GOTO 120
210 END
220 REM Set up the board
230 LET BA = -1
240 LET BB = -2
250 LET BC = -3
260 LET BD = -4
270 LET BE = -5
280 LET BF = -6
290 LET BG = -7
300 LET BH = -8
310 LET BI = -9
320 RETURN
330 REM Draw the board
340 PRINT " " ;
350 LET B = BA
360 GOSUB 600
370 LET B = BB
380 GOSUB 600
390 LET B = BC
400 GOSUB 600
410 PRINT
420 PRINT " " ;
430 LET B = BD
440 GOSUB 600
450 LET B = BE
460 GOSUB 600
470 LET B = BF
480 GOSUB 600
490 PRINT
500 PRINT " " ;
510 LET B = BG
520 GOSUB 600
530 LET B = BH
540 GOSUB 600
550 LET B = BI
560 GOSUB 600
570 PRINT
580 PRINT
590 RETURN
600 REM Draw a piece on the board
610 IF B < 0 GOTO 670
620 IF B = 1 GOTO 650
630 PRINT "X" ;
640 RETURN
650 PRINT "O" ;
660 RETURN
670 LET B = ABS(B)
680 PRINT B ;
690 RETURN
700 REM The computer makes a move, and it is dumb
710 PRINT "THE COMPUTER MAKES A MOVE..."
720 PRINT
730 REM Complete a horizontal line to win
740 IF BA = 2 AND BB = 2 AND BC < 0 GOTO 1450
750 IF BA = 2 AND BB < 0 AND BC = 2 GOTO 1430
760 IF BA < 0 AND BB = 2 AND BC = 2 GOTO 1410
770 IF BD = 2 AND BE = 2 AND BF < 0 GOTO 1520
780 IF BD = 2 AND BE < 0 AND BF = 2 GOTO 1490
790 IF BD < 0 AND BE = 2 AND BF = 2 GOTO 1470
800 IF BG = 2 AND BH = 2 AND BI < 0 GOTO 1570
810 IF BG = 2 AND BH < 0 AND BI = 2 GOTO 1550
820 IF BG < 0 AND BH = 2 AND BI = 2 GOTO 1530
830 REM Complete a vertical line to win
840 IF BA = 2 AND BD = 2 AND BG < 0 GOTO 1530
850 IF BA = 2 AND BD < 0 AND BG = 2 GOTO 1470
860 IF BA < 0 AND BD = 2 AND BG = 2 GOTO 1410
870 IF BB = 2 AND BE = 2 AND BH < 0 GOTO 1550
880 IF BB = 2 AND BE < 0 AND BH = 2 GOTO 1490
890 IF BB < 0 AND BE = 2 AND BH = 2 GOTO 1430
900 IF BC = 2 AND BF = 2 AND BI < 0 GOTO 1570
910 IF BC = 2 AND BF < 0 AND BI = 2 GOTO 1520
920 IF BC < 0 AND BF = 2 AND BI = 2 GOTO 1450
930 REM Complete a diagonal line to win
940 IF BA = 2 AND BE = 2 AND BI < 0 GOTO 1570
950 IF BA = 2 AND BE < 0 AND BI = 2 GOTO 1490
960 IF BA < 0 AND BE = 2 AND BI = 2 GOTO 1410
970 IF BC = 2 AND BE = 2 AND BG < 0 GOTO 1530
980 IF BC = 2 AND BE < 0 AND BG = 2 GOTO 1490
990 IF BC < 0 AND BE = 2 AND BG = 2 GOTO 1450
1000 REM Block an opponents horizontal line
1010 IF BA = 1 AND BB = 1 AND BC < 0 GOTO 1450
1020 IF BA = 1 AND BB < 0 AND BC = 1 GOTO 1430
1030 IF BA < 0 AND BB = 1 AND BC = 1 GOTO 1410
1040 IF BD = 1 AND BE = 1 AND BF < 0 GOTO 1520
1050 IF BD = 1 AND BE < 0 AND BF = 1 GOTO 1490
1060 IF BD < 0 AND BE = 1 AND BF = 1 GOTO 1470
1070 IF BG = 1 AND BH = 1 AND BI < 0 GOTO 1570
1080 IF BG = 1 AND BH < 0 AND BI = 1 GOTO 1550
1090 IF BG < 0 AND BH = 1 AND BI = 1 GOTO 1530
1100 REM Block an opponents vertical line
1110 IF BA = 1 AND BD = 1 AND BG < 0 GOTO 1530
1120 IF BA = 1 AND BD < 0 AND BG = 1 GOTO 1470
1130 IF BA < 0 AND BD = 1 AND BG = 1 GOTO 1410
1140 IF BB = 1 AND BE = 1 AND BH < 0 GOTO 1550
1150 IF BB = 1 AND BE < 0 AND BH = 1 GOTO 1490
1160 IF BB < 0 AND BE = 1 AND BH = 1 GOTO 1430
1170 IF BC = 1 AND BF = 1 AND BI < 0 GOTO 1570
1180 IF BC = 1 AND BF < 0 AND BI = 1 GOTO 1520
1190 IF BC < 0 AND BF = 1 AND BI = 1 GOTO 1450
1200 REM Block an opponents diagonal line
1210 IF BA = 1 AND BE = 1 AND BI < 0 GOTO 1570
1220 IF BA = 1 AND BE < 0 AND BI = 1 GOTO 1490
1230 IF BA < 0 AND BE = 1 AND BI = 1 GOTO 1410
1240 IF BC = 1 AND BE = 1 AND BG < 0 GOTO 1530
1250 IF BC = 1 AND BE < 0 AND BG = 1 GOTO 1490
1260 IF BC < 0 AND BE = 1 AND BG = 1 GOTO 1450
1270 REM Ok, I have no great ideas
1280 IF BE < 0 GOTO 1490
1290 IF BA < 0 GOTO 1410
1300 IF BB < 0 GOTO 1430
1310 IF BC < 0 GOTO 1450
1320 IF BD < 0 GOTO 1470
1330 IF BF < 0 GOTO 1510
1340 IF BG < 0 GOTO 1530
1350 IF BH < 0 GOTO 1550
1360 IF BI < 0 GOTO 1570
1370 PRINT
1380 PRINT "ERROR WHEN COMPUTER MAKES A MOVE, SORRY"
1390 END
1400 REM Set the computers selected location
1410 LET BA = 2
1420 RETURN
1430 LET BB = 2
1440 RETURN
1450 LET BC = 2
1460 RETURN
1470 LET BD = 2
1480 RETURN
1490 LET BE = 2
1500 RETURN
1510 LET BF = 2
1520 RETURN
1530 LET BG = 2
1540 RETURN
1550 LET BH = 2
1560 RETURN
1570 LET BI = 2
1580 RETURN
1590 RETURN
1600 REM Check if anyone won
1610 IF (BA = BB) AND (BB = BC) GOTO 1870
1620 IF (BD = BE) AND (BE = BF) GOTO 1870
1630 IF (BG = BH) AND (BH = BI) GOTO 1870
1640 IF (BA = BD) AND (BD = BG) GOTO 1870
1650 IF (BB = BE) AND (BE = BH) GOTO 1870
1660 IF (BC = BF) AND (BF = BI) GOTO 1870
1670 IF (BA = BE) AND (BE = BI) GOTO 1870
1680 IF (BC = BE) AND (BE = BG) GOTO 1870
1690 REM No one has won
1700 LET C = 0
1710 IF BA > 0 GOSUB 1840
1720 IF BB > 0 GOSUB 1840
1730 IF BC > 0 GOSUB 1840
1740 IF BD > 0 GOSUB 1840
1750 IF BE > 0 GOSUB 1840
1760 IF BF > 0 GOSUB 1840
1770 IF BG > 0 GOSUB 1840
1780 IF BH > 0 GOSUB 1840
1790 IF BI > 0 GOSUB 1840
1800 IF C <> 9 GOTO 1860
1810 PRINT
1820 PRINT "IT'S A DRAW"
1830 END
1840 LET C = C + 1
1850 RETURN
1860 RETURN
1870 IF P = 1 GOTO 1900
1880 PRINT "THE COMPUTER, AS X, WON!!!"
1890 END
1900 PRINT "THE PLAYER, AS O, WON!!!"
1910 END
1920 REM Get the players choice
1930 INPUT "SELECT AN AVAILABLE POSITION 1-9:" M
1940 REM PRINT M BA BB BC BD BE BF BG BH BI
1950 IF M < 1 OR M > 9 GOTO 1930
1960 IF M <> 1 GOTO 2000
1970 IF BA > 0 GOTO 2000
1980 LET BA = P
1990 RETURN
2000 IF M <> 2 GOTO 2040
2010 IF BB > 0 GOTO 2040
2020 LET BB = P
2030 RETURN
2040 IF M <> 3 GOTO 2080
2050 IF BC > 0 GOTO 2080
2060 LET BC = P
2070 RETURN
2080 IF M <> 4 GOTO 2120
2090 IF BD > 0 GOTO 2120
2100 LET BD = P
2110 RETURN
2120 IF M <> 5 GOTO 2160
2130 IF BE > 0 GOTO 2160
2140 LET BE = P
2150 RETURN
2160 IF M <> 6 GOTO 2200
2170 IF BF > 0 GOTO 2200
2180 LET BF = P
2190 RETURN
2200 IF M <> 7 GOTO 2240
2210 IF BG > 0 GOTO 2240
2220 LET BG = P
2230 RETURN
2240 IF M <> 8 GOTO 2280
2250 IF BH > 0 GOTO 2280
2260 LET BH = P
2270 RETURN
2280 IF M <> 9 GOTO 2320
2290 IF BI > 0 GOTO 2320
2300 LET BI = P
2310 RETURN
2320 REM No valid move
2330 GOTO 1930
